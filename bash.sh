#!/bin/bash

# Check if program name is provided
if [ -z "$1" ]; then
    echo "Please provide the program name as an argument."
    exit 1
fi

# Get the program name from the first argument
PROGRAM_NAME="$1.cpp"
OUTPUT_NAME="$1"

echo "Compiling $PROGRAM_NAME with ThreadSanitizer..."
# g++ -fsanitize=thread -g -O1 $PROGRAM_NAME -o $OUTPUT_NAME
g++ -fsanitize=thread -g -pie -fPIE $PROGRAM_NAME -o $OUTPUT_NAME

# clang++ -fsanitize=thread -g -O1 $PROGRAM_NAME -o $OUTPUT_NAME
# clang++ -Wthread-safety -g -O1 $PROGRAM_NAME -o $OUTPUT_NAME


if [ $? -eq 0 ]; then
    echo "Compilation successful. Running the program..."
    ./$OUTPUT_NAME
else
    echo "Compilation failed."
fi
